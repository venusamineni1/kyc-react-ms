server:
  port: 8080

spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true
          lower-case-service-id: true
      routes:
        - id: risk-service
          uri: lb://risk-service
          predicates:
            - Path=/api/risk/**, /api/internal/risk/**
          filters:
            - RewritePath=/api/risk/(?<remaining>.*), /api/internal/risk/${remaining}
        - id: screening-service
          uri: lb://screening-service
          predicates:
            - Path=/api/screening/**, /api/internal/screening/**
          filters:
            - RewritePath=/api/screening/(?<remaining>.*), /api/internal/screening/${remaining}
        - id: auth-service
          uri: lb://auth-service
          predicates:
            - Path=/auth/**, /api/auth/**, /api/users/**, /api/permissions/**
          filters:
            - RewritePath=/api/auth/(?<remaining>.*), /auth/${remaining}
        - id: document-service
          uri: lb://document-service
          predicates:
            - Path=/api/documents/**
        - id: core-viewer
          uri: lb://viewer-core
          predicates:
            - Path=/api/**, /login, /logout, /
            # Fallback for UI assets ??
            # Actually, the Frontend is currently bundled in Viewer. 
            # If Viewer moves to 8083, Gateway at 8080 must proxy EVERYTHING deeper.
            # So Path=/** might be needed as a catch-all route to Viewer.
        - id: core-viewer-catchall
          uri: lb://viewer-core
          predicates:
            - Path=/**

eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
  instance:
    prefer-ip-address: false
    hostname: localhost
